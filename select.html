<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Names Selector</title>
</head>
<body>
    <h1>Seleccione un nombre de usuario:</h1>
    <select id="userNames"></select>
    <button onclick="fillForm()">Llenar formulario</button>

    <script>
        const GOOGLE_CLIENT_ID = '758435428249-7a7q9l2h56r78ao4t4ulcln1m9np3ub8.apps.googleusercontent.com'; // Reemplaza con tu ID de cliente de Google
        const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly';

        async function initialize() {
            await gapi.client.init({
                apiKey: 'AIzaSyCBl2mg8VKEHc1vDB-O0J7T4qXxJZrYEFw', // Reemplaza con tu clave de API de Google
                discoveryDocs: [DISCOVERY_DOC],
            });
        }

        async function listUserNames() {
            const response = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1JWs9za4xtOHW9vgi-qXAsK66vNI6YSZghfyLgMYgzrg', // Reemplaza con el ID de tu hoja
                range: 'Pub!A1:A', // Reemplaza con el rango correcto
            });

            const range = response.result;
            const userNames = range.values.flat();
            const selectElement = document.getElementById('userNames');

            userNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.text = name;
                selectElement.appendChild(option);
            });
        }

        async function fillForm() {
            const selectedUserName = document.getElementById('userNames').value;
            // LÃ³gica para llenar el formulario con el nombre seleccionado
            // ...
        }

        gapi.load('client', async () => {
            await initialize();
            await gapi.client.load('sheets', 'v4');
            await listUserNames();
        });
    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapi.Load()"></script>
</body>
</html>
